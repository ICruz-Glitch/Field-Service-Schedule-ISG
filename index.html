<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Service Scheduler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    header { padding: 10px; background: #333; color: #fff; text-align: center; }
    #controls { display: flex; justify-content: space-between; padding: 10px; }
    #techList span { margin-right: 10px; padding: 4px 6px; border-radius: 4px; color: #fff; cursor: pointer; }
    #calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; margin: 10px; background: #ccc; }
    .day { background: #fff; padding: 5px; min-height: 80px; position: relative; cursor: pointer; }
    .day:hover { background: #f0f0f0; }
    .event { position: absolute; top: 20px; left: 0; right: 0; padding: 2px; font-size: 12px; color: #fff; }
    .hidden { display: none; }
    #monthTabs button { margin: 5px; padding: 5px 10px; }
  </style>
</head>
<body>
  <header>
    <h2>Field Service Scheduler - Monthly View</h2>
  </header>
  <div id="controls">
    <div>
      <button onclick="openTechModal()">Technician Settings</button>
    </div>
    <div id="techList"></div>
  </div>

  <div id="monthTabs"></div>
  <div id="calendar"></div>

  <div id="techModal" style="display:none; position:fixed; top:20%; left:30%; background:white; border:1px solid #ccc; padding:10px; z-index:1000">
    <h3>Edit Technicians</h3>
    <div id="techInputs"></div>
    <input id="newTechName" placeholder="Technician name">
    <input id="newTechColor" type="color">
    <button onclick="addTech()">Add Technician</button>
    <br><br>
    <button onclick="saveTechs()">Save</button>
    <button onclick="closeTechModal()">Close</button>
  </div>

  <script>
    let selectedTech = null;
    let techs = JSON.parse(localStorage.getItem('techs')) || [];
    let schedule = JSON.parse(localStorage.getItem('schedule')) || {};
    let currentYear = 2025;
    let currentMonth = 0;

    function renderMonthTabs() {
      const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
      const tabContainer = document.getElementById("monthTabs");
      tabContainer.innerHTML = "";
      for (let i = 0; i < 12; i++) {
        const btn = document.createElement("button");
        btn.textContent = monthNames[i];
        btn.onclick = () => {
          currentMonth = i;
          renderCalendar();
        };
        tabContainer.appendChild(btn);
      }
    }

    function renderCalendar() {
      const calendar = document.getElementById("calendar");
      calendar.innerHTML = "";
      const year = currentYear;
      const month = currentMonth;
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      for (let i = 0; i < firstDay; i++) {
        const filler = document.createElement("div");
        filler.className = "day hidden";
        calendar.appendChild(filler);
      }

      for (let day = 1; day <= daysInMonth; day++) {
        const dateStr = `${year}-${month + 1}-${day}`;
        const div = document.createElement("div");
        div.className = "day";
        div.innerHTML = `<strong>${day}</strong>`;
        if (schedule[dateStr]) {
          const ev = document.createElement("div");
          ev.className = "event";
          ev.textContent = schedule[dateStr].name;
          ev.style.backgroundColor = schedule[dateStr].color;
          div.appendChild(ev);
        }
        div.addEventListener("click", () => {
          if (selectedTech) {
            schedule[dateStr] = selectedTech;
            saveSchedule();
            renderCalendar();
          } else {
            alert("Select a technician first");
          }
        });
        calendar.appendChild(div);
      }
    }

    function renderTechs() {
      const techList = document.getElementById("techList");
      techList.innerHTML = "";
      techs.forEach((t, i) => {
        const span = document.createElement("span");
        span.textContent = t.name;
        span.style.backgroundColor = t.color;
        span.onclick = () => selectedTech = t;
        techList.appendChild(span);
      });
    }

    function openTechModal() {
      document.getElementById("techModal").style.display = "block";
      renderTechInputs();
    }

    function closeTechModal() {
      document.getElementById("techModal").style.display = "none";
    }

    function renderTechInputs() {
      const container = document.getElementById("techInputs");
      container.innerHTML = "";
      techs.forEach((t, i) => {
        const div = document.createElement("div");
        div.innerHTML = `<input value="${t.name}" onchange="editTechName(${i}, this.value)"> 
                          <input type="color" value="${t.color}" onchange="editTechColor(${i}, this.value)"> 
                          <button onclick="removeTech(${i})">Remove</button>`;
        container.appendChild(div);
      });
    }

    function editTechName(index, newName) {
      techs[index].name = newName;
      renderTechs();
    }

    function editTechColor(index, newColor) {
      techs[index].color = newColor;
      renderTechs();
    }

    function addTech() {
      const name = document.getElementById("newTechName").value;
      const color = document.getElementById("newTechColor").value;
      if (name && color) {
        techs.push({ name, color });
        document.getElementById("newTechName").value = "";
        renderTechInputs();
      }
    }

    function removeTech(index) {
      techs.splice(index, 1);
      renderTechInputs();
      renderTechs();
    }

    function saveTechs() {
      localStorage.setItem("techs", JSON.stringify(techs));
      renderTechs();
      closeTechModal();
    }

    function saveSchedule() {
      localStorage.setItem("schedule", JSON.stringify(schedule));
    }

    renderTechs();
    renderMonthTabs();
    renderCalendar();
  </script>
</body>
</html>